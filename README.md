# AstrBot 插件：Gender Identifier (性别识别器)

## 简介

本插件旨在增强 AstrBot 的情境感知能力。它通过在 LLM 请求前调用消息平台（如 NapCat for `aiocqhttp`）的 API 来获取用户的公开性别信息，并将其作为一个简单的标签（如 `[男性用户]`）添加到提示词中。

这使得大型语言模型能够根据用户的性别进行更细微、更个性化的回应。

## 特性

- **自动识别**: 在支持的平台上自动获取用户性别。
- **高度可配**: 用户可以自定义用于男性、女性和未知性别的提示词。
- **灵活插入**: 可以选择将提示词前置或后置。
- **智能缓存**: 内置缓存机制，避免对平台 API 的频繁请求，提高性能。
- **平台兼容**: 主要为 `aiocqhttp` (NapCat, Lagrange) 等支持获取用户信息的平台设计，在其他平台上会优雅地回退到“性别未知”。
- **调试模式**: 内置详细的调试日志开关，方便开发者排查问题。
- **调试指令**: 提供 `/mygender` 指令，方便用户查看插件检测到的自身性别信息。

## 安装

1.  在 AstrBot 插件市场搜索 `Gender Identifier`。
2.  点击安装。
3.  重载插件后即可使用。

## 配置

安装后，请在 AstrBot 管理面板的**插件管理**页面找到本插件，并根据你的需求进行配置：

-   `enable_plugin`: 启用或禁用插件。
-   `enable_debug_log`: 启用详细的调试日志，方便排查问题。
-   `male_prompt`: 检测到男性用户时使用的提示词。
-   `female_prompt`: 检测到女性用户时使用的提示词。
-   `unknown_prompt`: 无法确定性别或平台不支持时使用的提示词。
-   `prompt_position`: 提示词相对于原始消息的位置（`prefix` 前置 / `suffix` 后置）。
-   `cache_duration`: 缓存时间（秒），在此时间内不会重复请求 API。设为 `0` 关闭缓存。

## 使用

插件安装并启用后会自动运行。当用户与机器人对话时，插件会静默地修改发往 LLM 的请求。

你可以通过发送 `/mygender` 指令来测试插件是否正常工作。

## 注意事项

-   本插件依赖于消息平台提供的 API 来获取性别信息。并非所有平台都支持此功能。
-   获取到的性别信息基于用户在相应平台（如QQ）的公开设置，可能不准确或未设置。
-   请尊重用户隐私，合理使用此功能。
