```markdown
# astrbot_plugin_gender_detector

æ™ºèƒ½è¯†åˆ«ç”¨æˆ·æ€§åˆ«å¹¶è‡ªåŠ¨æ·»åŠ åˆ° LLM prompt çš„æ’ä»¶ï¼Œæ”¯æŒç§°å‘¼ç¼“å­˜å’Œç¾¤æˆå‘˜æ‰«æ

<div align="center">

[![Version](https://img.shields.io/badge/version-0.0.1-blue.svg)](https://github.com/xSapientia/astrbot_plugin_gender_detector)
[![AstrBot](https://img.shields.io/badge/AstrBot-%3E%3D3.4.0-green.svg)](https://github.com/Soulter/AstrBot)
[![License](https://img.shields.io/badge/license-MIT-yellow.svg)](LICENSE)

è®©ä½ çš„ AstrBot æ›´æ‡‚ç”¨æˆ·ï¼Œè‡ªåŠ¨è¯†åˆ«æ€§åˆ«å’Œç§°å‘¼ï¼

</div>

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ” æ™ºèƒ½è¯†åˆ«
- **è‡ªåŠ¨æ€§åˆ«è¯†åˆ«**: é€šè¿‡ QQ å¹³å° API è‡ªåŠ¨è·å–ç”¨æˆ·æ€§åˆ«ä¿¡æ¯
- **æ™ºèƒ½ç§°å‘¼æå–**: ä»å¯¹è¯ä¸­æ™ºèƒ½è¯†åˆ«ç”¨æˆ·çš„è‡ªæˆ‘ä»‹ç»å’Œä»–äººå¯¹å…¶çš„ç§°å‘¼
- **å¤šç”¨æˆ·ç»Ÿè®¡**: æ™ºèƒ½ç»Ÿè®¡æ¶ˆæ¯ä¸­æ¶‰åŠçš„æ‰€æœ‰ç”¨æˆ·ä¿¡æ¯
- **æ‰‹åŠ¨è®¾ç½®æ”¯æŒ**: å½“ API æ— æ³•è·å–æ€§åˆ«æ—¶ï¼Œæ”¯æŒæ‰‹åŠ¨è®¾ç½®

### ğŸ’¾ é«˜æ•ˆç¼“å­˜
- **ä¿¡æ¯ç¼“å­˜**: ç¼“å­˜ç”¨æˆ·æ€§åˆ«å’Œæ˜µç§°ä¿¡æ¯ï¼Œé¿å…é‡å¤ API è°ƒç”¨
- **ç§°å‘¼ä¼˜å…ˆçº§**: æŒ‰ `æœ¬äººå¼ºè°ƒç§°å‘¼ > ä»–äººç§°å‘¼ > é»˜è®¤ç§°å‘¼` çš„ä¼˜å…ˆçº§ç®¡ç†
- **è¿‡æœŸæ¸…ç†**: è‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜ï¼Œä¿æŒæ•°æ®æ–°é²œ
- **æ‰‹åŠ¨æ€§åˆ«ç¼“å­˜**: å•ç‹¬å­˜å‚¨æ‰‹åŠ¨è®¾ç½®çš„æ€§åˆ«ä¿¡æ¯

### ğŸ¤– LLM å¢å¼º
- **Prompt è‡ªåŠ¨æ³¨å…¥**: åœ¨ LLM è¯·æ±‚æ—¶è‡ªåŠ¨æ·»åŠ ç”¨æˆ·æ€§åˆ«å’Œç§°å‘¼ä¿¡æ¯
- **äººæ ¼é€‚é…**: æ ¹æ® AstrBot è®¾å®šçš„äººæ ¼ç¡®å®šé»˜è®¤ç§°å‘¼ä¹ æƒ¯
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**: è¯†åˆ«å¯¹è¯ä¸­æ‰€æœ‰ç›¸å…³ç”¨æˆ·ï¼Œæä¾›å®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯

### ğŸ“Š ç¾¤ç»„ç®¡ç†
- **ç¾¤æˆå‘˜æ‰«æ**: ä¸€é”®æ‰«æç¾¤å†…æ‰€æœ‰æˆå‘˜çš„æ€§åˆ«ä¿¡æ¯
- **å®šæ—¶æ‰«æ**: æ”¯æŒæ¯æ—¥å®šæ—¶è‡ªåŠ¨æ‰«æï¼Œä¿æŒä¿¡æ¯æ›´æ–°
- **ç»Ÿè®¡åˆ†æ**: æä¾›ç¾¤ç»„æ€§åˆ«åˆ†å¸ƒç»Ÿè®¡
- **æ˜µç§°ä¼˜å…ˆçº§**: ç¾¤å¤´è¡” > ç¾¤åç‰‡ > QQæ˜µç§°

### ğŸ› ï¸ è°ƒè¯•å·¥å…·
- **è°ƒè¯•æ¨¡å¼**: è¯¦ç»†çš„è°ƒè¯•æ—¥å¿—ï¼Œå¸®åŠ©å®šä½é—®é¢˜
- **è¯Šæ–­å‘½ä»¤**: `/gender_debug` æ˜¾ç¤ºåŸå§‹ API å“åº”
- **æ‰‹åŠ¨è®¾ç½®**: æ”¯æŒæ‰‹åŠ¨è®¾ç½®æ€§åˆ«ï¼Œè§£å†³ API æ— æ³•è·å–çš„é—®é¢˜

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### åŸºç¡€æŒ‡ä»¤

| æŒ‡ä»¤ | åˆ«å | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|------|------|------|----------|
| `/gender` | `æ€§åˆ«` | æŸ¥çœ‹ç”¨æˆ·æ€§åˆ« | å¯æŸ¥çœ‹è‡ªå·±æˆ–@ä»–äººçš„æ€§åˆ« |
| `/gender_set` | `è®¾ç½®æ€§åˆ«` | æ‰‹åŠ¨è®¾ç½®æ€§åˆ« | å½“APIæ— æ³•è·å–æ—¶ä½¿ç”¨ |
| `/gender_scan` | `gscan`, `ç¾¤æ‰«æ` | æ‰«æç¾¤æˆå‘˜ä¿¡æ¯ | ä»…é™ç¾¤èŠä½¿ç”¨ |
| `/gender_debug` | `gd`, `æ€§åˆ«è°ƒè¯•` | æ˜¾ç¤ºAPIåŸå§‹å“åº” | è°ƒè¯•ä½¿ç”¨ |

### ä½¿ç”¨ç¤ºä¾‹

```
# æŸ¥çœ‹è‡ªå·±çš„æ€§åˆ«
/gender

# æŸ¥çœ‹ä»–äººçš„æ€§åˆ«
/gender @æŸäºº

# æ‰‹åŠ¨è®¾ç½®è‡ªå·±çš„æ€§åˆ«
/gender_set ç”·

# è®¾ç½®ä»–äººæ€§åˆ«ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
/gender_set @æŸäºº å¥³

# æ‰«æç¾¤æˆå‘˜
/gscan

# è°ƒè¯•æ¨¡å¼
/gender_debug
```

## âš™ï¸ é…ç½®è¯´æ˜

æ’ä»¶æ”¯æŒåœ¨ AstrBot ç®¡ç†é¢æ¿ä¸­è¿›è¡Œå¯è§†åŒ–é…ç½®ï¼š

### åŸºç¡€é…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enable_plugin` | bool | true | æ’ä»¶æ€»å¼€å…³ |
| `show_debug_info` | bool | false | æ˜¯å¦æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ |
| `max_cached_nicknames` | int | 5 | æ¯ä¸ªç”¨æˆ·æœ€å¤šç¼“å­˜çš„ç§°å‘¼æ•°é‡ |

### è‡ªåŠ¨æ‰«æé…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enable_daily_scan` | bool | true | æ˜¯å¦å¯ç”¨æ¯æ—¥è‡ªåŠ¨æ‰«æ |
| `daily_scan_time` | string | "03:00" | æ¯æ—¥æ‰«ææ—¶é—´ï¼ˆ24å°æ—¶åˆ¶ï¼‰ |

### ç¼“å­˜è®¾ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `cache_expire_days` | int | 30 | ç¼“å­˜æœ‰æ•ˆæœŸï¼ˆå¤©ï¼‰ |
| `auto_clean_cache` | bool | true | æ˜¯å¦è‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜ |

### æ‰‹åŠ¨æ€§åˆ«è®¾ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `enable_manual_set` | bool | true | å…è®¸æ‰‹åŠ¨è®¾ç½®æ€§åˆ« |
| `admin_only` | bool | true | ä»…ç®¡ç†å‘˜å¯è®¾ç½®ä»–äººæ€§åˆ« |

### å¸è½½æ¸…ç†

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `delete_plugin_data` | bool | false | å¸è½½æ—¶æ˜¯å¦åˆ é™¤æ•°æ®ç›®å½• |
| `delete_config` | bool | false | å¸è½½æ—¶æ˜¯å¦åˆ é™¤é…ç½®æ–‡ä»¶ |

## ğŸ”§ å·¥ä½œåŸç†

### æ€§åˆ«è¯†åˆ«æµç¨‹

1. **æ‰‹åŠ¨è®¾ç½®ä¼˜å…ˆ**: é¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰æ‰‹åŠ¨è®¾ç½®çš„æ€§åˆ«
2. **ç¼“å­˜æŸ¥è¯¢**: æ£€æŸ¥æœ¬åœ°ç¼“å­˜æ˜¯å¦æœ‰æ€§åˆ«ä¿¡æ¯
3. **API è·å–**: é€šè¿‡ QQ API è·å–æ€§åˆ«ä¿¡æ¯
4. **é™çº§å¤„ç†**: API è¿”å› "unknown" æ—¶æç¤ºæ‰‹åŠ¨è®¾ç½®

### ç§°å‘¼è¯†åˆ«æœºåˆ¶

1. **è‡ªæˆ‘ä»‹ç»è¯†åˆ«**: è¯†åˆ«å¦‚ "æˆ‘å«xxx"ã€"è¯·å«æˆ‘xxx" ç­‰æ¨¡å¼
2. **ä»–äººç§°å‘¼è¯†åˆ«**: è¯†åˆ« "@xxx" ç­‰ç§°å‘¼æ¨¡å¼
3. **ä¼˜å…ˆçº§ç®¡ç†**: è‡ªåŠ¨æŒ‰ä¼˜å…ˆçº§æ’åºå’Œç®¡ç†å¤šä¸ªç§°å‘¼
4. **ç¾¤å†…ç§°å‘¼**: ç¾¤å¤´è¡” > ç¾¤åç‰‡ > QQæ˜µç§°

### LLM Prompt æ³¨å…¥

åœ¨ LLM è¯·æ±‚æ—¶ï¼Œæ’ä»¶ä¼šï¼š
1. è¯†åˆ«æ¶ˆæ¯ä¸­æ¶‰åŠçš„æ‰€æœ‰ç”¨æˆ·
2. è·å–æ¯ä¸ªç”¨æˆ·çš„æ€§åˆ«å’Œæœ€ä½³ç§°å‘¼
3. æ„å»ºç”¨æˆ·ä¿¡æ¯æè¿°å¹¶æ³¨å…¥åˆ°ç³»ç»Ÿæç¤ºè¯ä¸­

ç¤ºä¾‹æ³¨å…¥å†…å®¹ï¼š
```
å½“å‰å¯¹è¯æ¶‰åŠçš„ç”¨æˆ·: [å‘é€è€…]å°æ˜(ç”·), å°çº¢(å¥³)
ç§°å‘¼ä¹ æƒ¯: å¯¹ç”·æ€§ç”¨æˆ·ä½¿ç”¨"å“¥å“¥"ï¼Œå¯¹å¥³æ€§ç”¨æˆ·ä½¿ç”¨"å§å§"
```

## ğŸ’¾ æ•°æ®å­˜å‚¨

æ’ä»¶æ•°æ®ä¿å­˜ä½ç½®ï¼š
- ç”¨æˆ·ç¼“å­˜ï¼š`data/plugin_data/astrbot_plugin_gender_detector/user_cache.json`
- ç§°å‘¼ä¼˜å…ˆçº§ï¼š`data/plugin_data/astrbot_plugin_gender_detector/nickname_priority.json`
- æ‰‹åŠ¨æ€§åˆ«è®¾ç½®ï¼š`data/plugin_data/astrbot_plugin_gender_detector/manual_gender.json`
- æ’ä»¶é…ç½®ï¼š`data/config/astrbot_plugin_gender_detector_config.json`

## ğŸš€ é«˜çº§ç‰¹æ€§

### æ™ºèƒ½ç¼“å­˜ç®¡ç†
- è‡ªåŠ¨æ›´æ–°è¿‡æœŸç”¨æˆ·ä¿¡æ¯
- æ™ºèƒ½åˆå¹¶é‡å¤ç§°å‘¼
- æŒ‰ä¼˜å…ˆçº§é™åˆ¶ç§°å‘¼æ•°é‡
- æ€§åˆ«æœªçŸ¥æ—¶è‡ªåŠ¨å°è¯•æ›´æ–°

### å¹³å°é€‚é…
- å®Œç¾æ”¯æŒ QQ å¹³å°ï¼ˆé€šè¿‡ NapCat/Lagrangeï¼‰
- ä¼˜å…ˆä½¿ç”¨ç¾¤æˆå‘˜ä¿¡æ¯ API
- é™çº§ä½¿ç”¨é™Œç”Ÿäººä¿¡æ¯ API
- é¢„ç•™å…¶ä»–å¹³å°æ‰©å±•æ¥å£

### æ€§èƒ½ä¼˜åŒ–
- å¼‚æ­¥ API è°ƒç”¨ï¼Œä¸é˜»å¡ä¸»æµç¨‹
- æ™ºèƒ½ç¼“å­˜å‡å°‘ API è¯·æ±‚
- æ‰¹é‡æ‰«æä¼˜åŒ–ç¾¤ç»„å¤„ç†
- å·®å¼‚åŒ–æ›´æ–°ç­–ç•¥

## ğŸ› æ•…éšœæ’é™¤

### æ’ä»¶æ— å“åº”
1. æ£€æŸ¥æ’ä»¶æ˜¯å¦å·²å¯ç”¨ï¼ˆ`enable_plugin` é…ç½®ï¼‰
2. æŸ¥çœ‹ AstrBot æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
3. ç¡®è®¤ä½¿ç”¨çš„æ˜¯æ”¯æŒçš„å¹³å°ï¼ˆQQ + NapCat/Lagrangeï¼‰

### æ€§åˆ«æ˜¾ç¤ºä¸º"æœªçŸ¥"
1. ç¡®è®¤ç”¨æˆ·åœ¨ QQ ä¸­è®¾ç½®äº†æ€§åˆ«
2. æ£€æŸ¥æœºå™¨äººæ˜¯å¦æœ‰è·å–ç”¨æˆ·ä¿¡æ¯çš„æƒé™
3. ä½¿ç”¨ `/gender_debug` æŸ¥çœ‹ API å“åº”
4. ä½¿ç”¨ `/gender_set` æ‰‹åŠ¨è®¾ç½®æ€§åˆ«

### ç§°å‘¼è¯†åˆ«ä¸å‡†ç¡®
1. å¼€å¯è°ƒè¯•æ¨¡å¼æŸ¥çœ‹è¯†åˆ«è¿‡ç¨‹
2. æ£€æŸ¥ç§°å‘¼ä¼˜å…ˆçº§è®¾ç½®
3. æ‰‹åŠ¨æ¸…ç†é”™è¯¯çš„ç¼“å­˜æ•°æ®

### API å“åº”é—®é¢˜
1. ç¡®ä¿ NapCat/Lagrange ç‰ˆæœ¬æ˜¯æœ€æ–°çš„
2. æ£€æŸ¥åè®®ç«¯æ—¥å¿—æ˜¯å¦æœ‰å¼‚å¸¸
3. ä½¿ç”¨ `/gender_debug` å‘½ä»¤æŸ¥çœ‹ API å“åº”æ ¼å¼
4. å¦‚æœæ€»æ˜¯è¿”å› "unknown"ï¼Œä½¿ç”¨æ‰‹åŠ¨è®¾ç½®åŠŸèƒ½

## ğŸ“ æ›´æ–°æ—¥å¿—

### v0.0.1 (2024-01-26)
- âœ… å®ç°ç”¨æˆ·æ€§åˆ«è‡ªåŠ¨è¯†åˆ«
- âœ… å®ç°æ™ºèƒ½ç§°å‘¼æå–å’Œä¼˜å…ˆçº§ç®¡ç†
- âœ… å®ç° LLM Prompt è‡ªåŠ¨æ³¨å…¥
- âœ… æ·»åŠ ç¾¤æˆå‘˜æ‰«æåŠŸèƒ½
- âœ… å®ç°å®šæ—¶è‡ªåŠ¨æ‰«æ
- âœ… æ·»åŠ ç¼“å­˜ç®¡ç†å’Œè¿‡æœŸæ¸…ç†
- âœ… æ”¯æŒè°ƒè¯•æ¨¡å¼å’Œè¯¦ç»†æ—¥å¿—
- âœ… æ·»åŠ  API å“åº”è¯Šæ–­å·¥å…·
- âœ… æ”¯æŒæ‰‹åŠ¨è®¾ç½®æ€§åˆ«åŠŸèƒ½
- âœ… ä¼˜åŒ–æ˜µç§°è·å–ä¼˜å…ˆçº§ï¼ˆç¾¤å¤´è¡”>ç¾¤åç‰‡>æ˜µç§°ï¼‰
- âœ… æ”¹è¿› "unknown" æ€§åˆ«çš„å¤„ç†

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘å»ºè®®
- æ·»åŠ æ›´å¤šå¹³å°æ”¯æŒ
- ä¼˜åŒ–ç§°å‘¼è¯†åˆ«ç®—æ³•
- å¢åŠ æ›´å¤šç»Ÿè®¡åŠŸèƒ½
- æ”¹è¿›ç¼“å­˜ç­–ç•¥

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ‘¨â€ğŸ’» ä½œè€…

- **xSapientia** - *Initial work* - [GitHub](https://github.com/xSapientia)

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢ [AstrBot](https://github.com/Soulter/AstrBot) é¡¹ç›®æä¾›çš„ä¼˜ç§€æ¡†æ¶
- æ„Ÿè°¢ [NapCat](https://github.com/NapNeko/NapCatQQ) æä¾›çš„ QQ æœºå™¨äººåè®®æ”¯æŒ

---

<div align="center">

å¦‚æœè¿™ä¸ªæ’ä»¶å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ Starï¼

[æŠ¥å‘Šé—®é¢˜](https://github.com/xSapientia/astrbot_plugin_gender_detector/issues) Â· [åŠŸèƒ½å»ºè®®](https://github.com/xSapientia/astrbot_plugin_gender_detector/issues) Â· [æŸ¥çœ‹æ›´å¤šæ’ä»¶](https://github.com/xSapientia)

</div>
```
